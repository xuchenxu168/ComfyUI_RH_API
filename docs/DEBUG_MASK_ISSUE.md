# ğŸ” Mask Upload Debug Guide

## é—®é¢˜åˆ†æ

æ ¹æ®æ—¥å¿—ï¼Œé®ç½©ä¸Šä¼ **æˆåŠŸ**äº†ï¼Œä½†ä»»åŠ¡æ‰§è¡Œæ—¶å¡ä½äº†ã€‚

### æˆåŠŸçš„éƒ¨åˆ†
```
âœ… Mask uploaded successfully: api/5cfc44f29b012406eb2549c85c4742a01023c2db6236fd872caec3e3b4005b3a.png
âœ“ RH Param added: Node 319.Load Image = api/5cfc44f29b012406eb2549c85c4742a01023c2db6236fd...
âœ“ Task created: 1989742127204765697
âœ“ WebSocket connected
Task status: RUNNING
```

### é—®é¢˜
ä»»åŠ¡ä¸€ç›´å¤„äº RUNNING çŠ¶æ€ï¼Œæ²¡æœ‰è¿›å±•ï¼Œä¹Ÿæ²¡æœ‰å®Œæˆæˆ–æŠ¥é”™ã€‚

## å¯èƒ½çš„åŸå› 

### 1. å‚æ•°åç§°/èŠ‚ç‚¹ ID ä¸åŒ¹é… âš ï¸

**é—®é¢˜ï¼š** æ—¥å¿—æ˜¾ç¤º `Node 319.Load Image`ï¼Œä½†è¿™å¯èƒ½ä¸æ˜¯æ­£ç¡®çš„å‚æ•°åç§°ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1. åœ¨ RunningHub ç½‘ç«™ä¸Šæ‰“å¼€ä½ çš„å·¥ä½œæµ
2. æ‰¾åˆ°éœ€è¦é®ç½©çš„èŠ‚ç‚¹
3. æŸ¥çœ‹è¯¥èŠ‚ç‚¹çš„**ç¡®åˆ‡ ID å’Œå‚æ•°åç§°**
4. åœ¨ ComfyUI ä¸­ï¼Œç¡®ä¿ RH_Param çš„ `node_id` å’Œ `field_name` ä¸æœåŠ¡å™¨ç«¯å®Œå…¨åŒ¹é…

**ç¤ºä¾‹ï¼š**
```
æ­£ç¡®ï¼šNode 123.mask_image
é”™è¯¯ï¼šNode 319.Load Image
```

### 2. é®ç½©æ ¼å¼ä¸è¢«å·¥ä½œæµæ¥å— âš ï¸

**é—®é¢˜ï¼š** æœåŠ¡å™¨ç«¯çš„å·¥ä½œæµå¯èƒ½æœŸæœ›ä¸åŒçš„é®ç½©æ ¼å¼æˆ–å‚æ•°ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ RunningHub å·¥ä½œæµä¸­é®ç½©èŠ‚ç‚¹çš„ç±»å‹
2. ç¡®è®¤å®ƒæ˜¯å¦æ¥å—ä¸Šä¼ çš„å›¾åƒä½œä¸ºé®ç½©
3. å¯èƒ½éœ€è¦ä½¿ç”¨ `LoadImage` èŠ‚ç‚¹è€Œä¸æ˜¯ä¸“é—¨çš„é®ç½©èŠ‚ç‚¹

### 3. fileType å‚æ•°é—®é¢˜ âš ï¸

**é—®é¢˜ï¼š** RunningHub å¯èƒ½ä¸è¯†åˆ« `fileType: 'mask'`ï¼Œæˆ–è€…æœŸæœ›ä¸åŒçš„å€¼ã€‚

**å½“å‰å®ç°ï¼š**
```python
data = {
    'apiKey': api_key,
    'fileType': 'mask',  # å¯èƒ½ä¸è¢«è¯†åˆ«
}
```

**è§£å†³æ–¹æ¡ˆï¼š** å°è¯•ä½¿ç”¨ `'image'` è€Œä¸æ˜¯ `'mask'`

### 4. å·¥ä½œæµæœ¬èº«çš„é—®é¢˜ âš ï¸

**é—®é¢˜ï¼š** æœåŠ¡å™¨ç«¯çš„å·¥ä½œæµå¯èƒ½æœ‰é”™è¯¯ï¼Œå¯¼è‡´æ‰§è¡Œå¡ä½ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1. åœ¨ RunningHub ç½‘ç«™ä¸Šç›´æ¥æµ‹è¯•å·¥ä½œæµ
2. æ‰‹åŠ¨ä¸Šä¼ å›¾åƒå’Œé®ç½©
3. ç¡®è®¤å·¥ä½œæµå¯ä»¥æ­£å¸¸æ‰§è¡Œ

## ğŸ”§ è°ƒè¯•æ­¥éª¤

### æ­¥éª¤ 1: æ£€æŸ¥å‚æ•°é…ç½®

åœ¨ä½ çš„ ComfyUI å·¥ä½œæµä¸­ï¼Œæ‰¾åˆ°è¿æ¥åˆ° RH_UploadMask çš„ RH_Param èŠ‚ç‚¹ï¼š

```
RH_UploadMask
  â†“ file_hash
RH_Param
  node_id: "???"        â† æ£€æŸ¥è¿™ä¸ª
  field_name: "???"     â† æ£€æŸ¥è¿™ä¸ª
  field_value: {{MASK_HASH}}
```

**éœ€è¦ç¡®è®¤ï¼š**
- `node_id` æ˜¯å¦ä¸ RunningHub å·¥ä½œæµä¸­çš„èŠ‚ç‚¹ ID åŒ¹é…ï¼Ÿ
- `field_name` æ˜¯å¦æ˜¯æ­£ç¡®çš„å‚æ•°åç§°ï¼ˆå¯èƒ½æ˜¯ `mask`, `mask_image`, `image` ç­‰ï¼‰ï¼Ÿ

### æ­¥éª¤ 2: å°è¯•ä¿®æ”¹ fileType

ä¸´æ—¶ä¿®æ”¹ `rh_upload_mask.py`ï¼š

```python
# åŸæ¥çš„ä»£ç ï¼ˆç¬¬ 120 è¡Œï¼‰
data = {
    'apiKey': api_key,
    'fileType': 'mask',  # æ”¹ä¸º 'image'
}

# ä¿®æ”¹ä¸º
data = {
    'apiKey': api_key,
    'fileType': 'image',  # å°è¯•ä½¿ç”¨ 'image'
}
```

### æ­¥éª¤ 3: æ£€æŸ¥ RunningHub å·¥ä½œæµ

1. ç™»å½• RunningHub
2. æ‰“å¼€å·¥ä½œæµ ID: `1989726378499207170`
3. æ‰¾åˆ°éœ€è¦é®ç½©çš„èŠ‚ç‚¹
4. è®°å½•ä¸‹ï¼š
   - èŠ‚ç‚¹ IDï¼ˆä¾‹å¦‚ï¼š`123`ï¼‰
   - èŠ‚ç‚¹ç±»å‹ï¼ˆä¾‹å¦‚ï¼š`LoadImage`, `LoadImageMask`, ç­‰ï¼‰
   - å‚æ•°åç§°ï¼ˆä¾‹å¦‚ï¼š`image`, `mask`, `mask_image`ï¼‰

### æ­¥éª¤ 4: æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…

è®¿é—® RunningHub ä»»åŠ¡é¡µé¢ï¼š
```
https://www.runninghub.cn/task/detail/1989742127204765697
```

æŸ¥çœ‹ï¼š
- ä»»åŠ¡æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯ï¼Ÿ
- æ‰§è¡Œåˆ°å“ªä¸ªèŠ‚ç‚¹å¡ä½äº†ï¼Ÿ
- æ˜¯å¦æœ‰å‚æ•°é”™è¯¯ï¼Ÿ

## ğŸ› ï¸ å¿«é€Ÿä¿®å¤å»ºè®®

### ä¿®å¤ 1: ä½¿ç”¨ 'image' è€Œä¸æ˜¯ 'mask'

å¾ˆå¤šç³»ç»Ÿä¸åŒºåˆ†å›¾åƒå’Œé®ç½©çš„ä¸Šä¼ ç±»å‹ï¼Œéƒ½ä½¿ç”¨ `'image'`ã€‚

**ä¿®æ”¹æ–‡ä»¶ï¼š** `nodes/rh_upload_mask.py` ç¬¬ 120 è¡Œ

```python
data = {
    'apiKey': api_key,
    'fileType': 'image',  # æ”¹ä¸º 'image'
}
```

### ä¿®å¤ 2: æ£€æŸ¥å‚æ•°åç§°

ç¡®ä¿ RH_Param ä¸­çš„å‚æ•°åç§°æ­£ç¡®ã€‚å¸¸è§çš„é®ç½©å‚æ•°åç§°ï¼š
- `mask`
- `mask_image`
- `image` (å¦‚æœä½¿ç”¨ LoadImage èŠ‚ç‚¹)
- `mask_input`

### ä¿®å¤ 3: æ·»åŠ è¶…æ—¶å¤„ç†

å¦‚æœå·¥ä½œæµç¡®å®éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå¯èƒ½éœ€è¦å¢åŠ è¶…æ—¶æ—¶é—´ã€‚

## ğŸ“Š å¯¹æ¯”ï¼šæˆåŠŸçš„å›¾åƒä¸Šä¼  vs é®ç½©ä¸Šä¼ 

### æˆåŠŸçš„å›¾åƒä¸Šä¼ 
```
âœ“ Image uploaded: api/449134da8a794e9946bfb10de46f92c56680e36410f7ce481bcc67a69329493f.png
âœ“ RH Param added: Node 318.Load Image = api/449134da...
```

### é®ç½©ä¸Šä¼ 
```
âœ… Mask uploaded successfully: api/5cfc44f29b012406eb2549c85c4742a01023c2db6236fd872caec3e3b4005b3a.png
âœ“ RH Param added: Node 319.Load Image = api/5cfc44f29b...
```

**æ³¨æ„ï¼š** ä¸¤è€…éƒ½ä½¿ç”¨ `Load Image` èŠ‚ç‚¹ï¼Œè¿™æ˜¯æ­£ç¡®çš„ï¼

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å°è¯•ï¼š** å°† `fileType: 'mask'` æ”¹ä¸º `fileType: 'image'`
2. **éªŒè¯å‚æ•°ï¼š** åœ¨ RunningHub ä¸Šæ£€æŸ¥èŠ‚ç‚¹ 319 çš„ç¡®åˆ‡å‚æ•°åç§°
3. **æµ‹è¯•å·¥ä½œæµï¼š** åœ¨ RunningHub ç½‘ç«™ä¸Šæ‰‹åŠ¨æµ‹è¯•å·¥ä½œæµ
4. **æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼š** è®¿é—®ä»»åŠ¡é¡µé¢æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

## ğŸ’¡ æç¤º

å¦‚æœä¿®æ”¹ `fileType` åä»ç„¶å¡ä½ï¼Œé—®é¢˜å¾ˆå¯èƒ½æ˜¯ï¼š
- **æœåŠ¡å™¨ç«¯å·¥ä½œæµé…ç½®é”™è¯¯**
- **èŠ‚ç‚¹å‚æ•°åç§°ä¸åŒ¹é…**
- **å·¥ä½œæµæœ¬èº«æœ‰ bug**

å»ºè®®å…ˆåœ¨ RunningHub ç½‘ç«™ä¸Šæ‰‹åŠ¨æµ‹è¯•å·¥ä½œæµï¼Œç¡®è®¤å®ƒå¯ä»¥æ­£å¸¸å·¥ä½œã€‚

