# 示例：保存生成的图像和视频到本地

本示例展示如何自动将 RunningHub 的输出保存到本地 ComfyUI 输出目录。

## 为什么要保存到本地？

默认情况下，RunningHub 的输出会：
1. 下载并转换为张量供 ComfyUI 使用
2. 自动保存到本地磁盘供以后使用

这对以下场景很有用：
- 保留生成内容的永久副本
- 与他人分享文件
- 在其他应用程序中使用输出
- 建立生成内容库

## 基本设置与自动保存

### 1. 配置 RH_Execute 节点

`RH_Execute` 节点有两个参数用于控制文件保存：

- **save_to_local** (默认: True)
  - 启用/禁用自动保存
  - 启用时，所有输出都会保存到 ComfyUI 的输出目录
  
- **output_prefix** (默认: "RH")
  - 保存文件的前缀
  - 帮助组织你的文件

### 2. 示例工作流

```
┌─────────────┐
│  RH_Config  │
└──────┬──────┘
       │
       ↓
┌─────────────────────────────┐
│      RH_Execute             │
│                             │
│  save_to_local: True        │ ← 启用自动保存
│  output_prefix: "我的项目"  │ ← 自定义前缀
└──────┬──────────────────────┘
       │
       ↓
┌─────────────┐
│  预览图像   │
└─────────────┘
```

## 文件命名规则

文件按以下命名模式保存：

### 图像
```
{前缀}_{时间戳}_{编号}.{扩展名}

示例:
- RH_20251115_143022_001.png
- RH_20251115_143022_002.jpg
- 我的项目_20251115_143022_001.png
```

### 视频
```
{前缀}_{时间戳}_video_{编号}.{扩展名}

示例:
- RH_20251115_143022_video_001.mp4
- 我的项目_20251115_143022_video_001.webm
```

### 文本
```
{前缀}_{时间戳}_text.txt

示例:
- RH_20251115_143022_text.txt
- 我的项目_20251115_143022_text.txt
```

### 音频
```
{前缀}_{时间戳}_audio.{扩展名}

示例:
- RH_20251115_143022_audio.wav
- 我的项目_20251115_143022_audio.mp3
```

## 输出目录

文件保存到 ComfyUI 的输出目录：

**默认位置:**
```
ComfyUI/output/
```

执行后，你可以在此目录中找到保存的文件。

## 高级用法

### 为不同项目使用自定义前缀

使用不同的前缀来按项目组织输出：

```python
# 角色生成项目
output_prefix: "角色"
# 结果: 角色_20251115_143022_001.png

# 风景生成项目
output_prefix: "风景"
# 结果: 风景_20251115_143022_001.png

# 视频生成项目
output_prefix: "视频生成"
# 结果: 视频生成_20251115_143022_video_001.mp4
```

### 禁用自动保存

如果你只想在 ComfyUI 中使用输出而不保存：

```
RH_Execute:
  save_to_local: False
```

这在以下情况下很有用：
- 你只是在测试
- 你只需要输出用于 ComfyUI 中的进一步处理
- 你想节省磁盘空间

### 批量处理

在一个任务中生成多张图像时：

```
输入: 生成 4 张图像

输出文件:
- 我的项目_20251115_143022_001.png
- 我的项目_20251115_143022_002.png
- 我的项目_20251115_143022_003.png
- 我的项目_20251115_143022_004.png
```

同一任务的所有图像共享相同的时间戳。

## 提示

1. **按日期组织**: 时间戳包含日期和时间，便于查找最近的输出

2. **使用描述性前缀**: 选择描述你的项目或内容类型的前缀

3. **查看控制台输出**: 控制台会显示每个文件保存时的确切文件名：
   ```
   ✓ Saved image: 我的项目_20251115_143022_001.png
   ✓ Saved video: 我的项目_20251115_143022_video_001.mp4
   ```

4. **磁盘空间**: 记住视频文件可能很大。如果生成很多视频，请监控磁盘空间

5. **文件管理**: 定期清理旧输出以释放磁盘空间

## 故障排除

### "Warning: folder_paths not available"
- 插件会在当前目录创建 `output` 文件夹
- 这在 ComfyUI 外运行时是正常的

### 文件未保存
- 检查 `save_to_local` 是否设置为 `True`
- 验证你对输出目录有写权限
- 查看控制台的错误消息

### 找不到保存的文件
- 检查 ComfyUI 的输出目录: `ComfyUI/output/`
- 查找带有你指定前缀的文件
- 查看控制台输出以获取确切的文件名

## 示例：使用自定义前缀的完整工作流

```
1. RH_Config
   - api_key: 你的_api_key
   - workflow_or_app_id: 你的_workflow_id

2. RH_Param (可选)
   - node_id: "3"
   - field_name: "text"
   - field_value: "美丽的日落"

3. RH_Execute
   - config: 来自 RH_Config
   - params: 来自 RH_Param
   - save_to_local: True
   - output_prefix: "日落"
   
4. 预览图像
   - images: 来自 RH_Execute

结果:
- 图像在 ComfyUI 中显示
- 文件已保存: ComfyUI/output/日落_20251115_143022_001.png
```

---

有了自动文件保存，你再也不会丢失生成的内容！🎨💾

